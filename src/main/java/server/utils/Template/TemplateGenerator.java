package server.utils.Template;

import java.io.ByteArrayInputStream;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;
import com.lowagie.text.DocumentException;
import org.w3c.dom.Document;
import org.xhtmlrenderer.pdf.ITextRenderer;
import org.xhtmlrenderer.resource.XMLResource;
import org.xhtmlrenderer.util.IOUtil;
import server.model.Client;
import server.model.RoomBooking;
import server.utils.Mail.MailManager;

import java.io.*;
import java.lang.reflect.Array;
import java.time.LocalDate;
import  java.time.temporal.ChronoUnit;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Date;
import java.util.List;

public class TemplateGenerator {

    //For email
    private String invoiceRowTemplateForMail = "";
    String invoiceUpperTemplateForMail = "";
    String invoiceLowrTemplateForMail = "";

    //for pdf
    List<String>  listOfNew = new ArrayList<String>();

    List<String>  listOfOld = new ArrayList<String>();
    String patternDateForPdf = "dd/MM/yyyy";
    String dateInString = new SimpleDateFormat(patternDateForPdf).format(new Date());

//    Client client;    Booking reservation;    List<Booking> ListdeReservation;    String finalHtml;

    public TemplateGenerator(){

    }

    public String getProfessionnalInvoiceForMail (String bookingNum,String facturationDate,String clientFullName,String clientAddress,String clientCity,String clientCountry,int simpleQuantity,int doubleQuantity,int juniorQuantity,int executiveQuantity,double simplePrice,double doublePrice,double juniorPrice,double executivePrice,double totalPrice)
    {
        return "<html xmlns=\"http://www.w3.org/1999/xhtml\"><head> <title>THANK YOU</title> <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"> <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"> <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0 \"> <meta name=\"format-detection\" content=\"telephone=no\"> <link href=\"https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700,800\" rel=\"stylesheet\"> <style type=\"text/css\"> body{-webkit-text-size-adjust: 100% !important; -ms-text-size-adjust: 100% !important; -webkit-font-smoothing: antialiased !important;}img{border: 0 !important; outline: none !important;}p{Margin: 0px !important; Padding: 0px !important;}table{border-collapse: collapse; mso-table-lspace: 0px; mso-table-rspace: 0px;}td, a, span{border-collapse: collapse; mso-line-height-rule: exactly;}.ExternalClass *{line-height: 100%;}span.MsoHyperlink{mso-style-priority: 99; color: inherit;}span.MsoHyperlinkFollowed{mso-style-priority: 99; color: inherit;}.auto-style1{color: #33CC33;}.auto-style2{height: 157px;}.auto-style3{height: 99px;}.auto-style4{width: 100%;}.auto-style5{font-family: \"Open Sans\", Arial, sans-serif; font-size: 17px; color: #30373B;}.auto-style6{height: 154px; width: 93%;}.auto-style7{font-family: \"Open Sans\", Arial, sans-serif; font-size: 16px; color: #30373B;}</style> <style media=\"only screen and (min-width:481px) and (max-width:599px)\" type=\"text/css\"> @media only screen and (min-width:481px) and (max-width:599px){table[class=em_main_table]{width: 100% !important;}table[class=em_wrapper]{width: 100% !important;}td[class=em_hide], br[class=em_hide]{display: none !important;}img[class=em_full_img]{width: 100% !important; height: auto !important;}td[class=em_align_cent]{text-align: center !important;}td[class=em_pad_top]{padding-top: 20px !important;}td[class=em_aside]{padding-left: 10px !important; padding-right: 10px !important;}td[class=em_height]{height: 20px !important;}td[class=em_space]{width: 10px !important;}td[class=em_width55]{width: 80px !important; text-align: center !important;}td[class=em_width75]{width: 100px !important;}td[class=em_font]{font-size: 14px !important;}td[class=em_font2]{text-align: center !important;}td[class=em_align_cent1]{text-align: center !important; padding-bottom: 10px !important;}}</style> <style media=\"only screen and (max-width:480px)\" type=\"text/css\"> @media only screen and (max-width:480px){table[class=em_main_table]{width: 100% !important;}table[class=em_wrapper]{width: 100% !important;}td[class=em_hide], br[class=em_hide], span[class=em_hide]{display: none !important;}img[class=em_full_img]{width: 100% !important; height: auto !important;}td[class=em_align_cent]{text-align: center !important;}td[class=em_pad_top]{padding-top: 20px !important;}td[class=em_height]{height: 20px !important;}td[class=em_aside]{padding-left: 10px !important; padding-right: 10px !important;}td[class=em_font]{font-size: 14px !important; line-height: 28px !important;}td[class=em_font1]{font-size: 14px !important; line-height: 18px !important;}td[class=em_font2]{font-size: 14px !important; line-height: 18px !important; text-align: center !important;}td[class=em_space]{width: 10px !important;}span[class=em_br]{display: block !important;}td[class=em_width55]{width: 55px !important; font-size: 15px !important; line-height: 19px !important; text-align: center !important;}td[class=em_width75]{width: 75px !important; font-size: 15px !important; line-height: 19px !important;}td[class=em_align_cent1]{text-align: center !important; padding-bottom: 10px !important;}}</style></head><body style=\"margin:0px; padding:0px;\" bgcolor=\"#ffffff\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" bgcolor=\"#ffffff\"> <tbody><tr> <td align=\"center\" valign=\"top\" bgcolor=\"#ffffff\"> <hr><table width=\"600\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" align=\"center\" class=\"em_main_table\" style=\"table-layout:fixed;\"> <tbody><tr> <td height=\"40\" class=\"em_height\">&nbsp;</td></tr><tr> <td align=\"center\"><a href=\"#\" target=\"_blank\" style=\"text-decoration:none;\"><img src=\"http://residencedeshautsdemenaye.com/img/logoRHM.png\" width=\"390\" height=\"283\" style=\"display:block;font-family: Arial, sans-serif; font-size:15px; line-height:18px; color:#30373b; font-weight:bold;\" border=\"0\" alt=\"LoGo Here\"></a></td></tr><tr> <td height=\"30\" class=\"em_height\">&nbsp;</td></tr><tr> <td height=\"1\" bgcolor=\"#fed69c\" style=\"font-size:0px; line-height:0px;\"><img src=\"https://www.sendwithus.com/assets/img/emailmonks/images/spacer.gif\" width=\"1\" height=\"1\" style=\"display:block;\" border=\"0\" alt=\"\"></td></tr><tr> <td height=\"14\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td align=\"center\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:15px; line-height:18px; color:#30373b; text-transform:uppercase; font-weight:bold;\" class=\"em_font\"> <a href=\"#\" target=\"_blank\" style=\"text-decoration:none; color:#30373b;\">HOTEL</a> &nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp; <a href=\"#\" target=\"_blank\" style=\"text-decoration:none; color:#30373b;\">RESTAURANT</a> <span class=\"em_hide\"> &nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp; </span> <span class=\"em_br\"> </span><a href=\"#\" target=\"_blank\" style=\"text-decoration:none; color:#30373b;\">EVENTS</a> &nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp; <a href=\"#\" target=\"_blank\" style=\"text-decoration:none; color:#30373b;\">CONTACTEZ-NOUS</a> </td></tr><tr> <td height=\"14\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td height=\"1\" bgcolor=\"#fed69c\" style=\"font-size:0px; line-height:0px;\"><img src=\"https://www.sendwithus.com/assets/img/emailmonks/images/spacer.gif\" width=\"1\" height=\"1\" style=\"display:block;\" border=\"0\" alt=\"\"></td></tr><tr> <td valign=\"top\" class=\"em_aside\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"> <tbody><tr> <td height=\"50\" class=\"em_height\">&nbsp;</td></tr><tr> <td valign=\"middle\" align=\"center\"><h1>NOUS VOUS REMERCIONS</h1></td></tr><tr> <td height=\"14\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td align=\"center\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:18px; font-weight:bold; line-height:22px; color:#33cc33; text-transform:uppercase;\">Pour votre réservation!</td></tr><tr> <td height=\"25\" class=\"em_height\">&nbsp;</td></tr><tr> <td height=\"1\" bgcolor=\"#d6d7d8\" style=\"font-size:0px;line-height:0px;\"><img src=\"https://www.sendwithus.com/assets/img/emailmonks/images/spacer.gif\" width=\"1\" height=\"1\" alt=\"\" style=\"display:block;\" border=\"0\"></td></tr><tr> <td height=\"27\" class=\"em_height\">&nbsp;</td></tr><tr> <td valign=\"top\" align=\"center\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px;line-height:22px; font-weight:bold; color:#30373b; text-transform:uppercase;\">Votre facture</td></tr><tr> <td height=\"23\" class=\"em_height\">&nbsp;</td></tr><tr> <td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"> <tbody><tr> <td valign=\"top\"> <table width=\"290\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"left\" class=\"em_wrapper\" bgcolor=\"#f6f7f8\"> <tbody><tr> <td align=\"center\" valign=\"middle\" class=\"em_font1\" height=\"42\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; font-weight:bold; color:#30373b; text-transform:uppercase;\"> <span style=\"color:#33cc33;\">Numéro de réservation :</span>"+ bookingNum+" </td></tr></tbody></table> <table width=\"290\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"right\" class=\"em_wrapper\"> <tbody><tr> <td valign=\"top\" class=\"em_pad_top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" bgcolor=\"#f6f7f8\"> <tbody><tr> <td align=\"center\" valign=\"middle\" class=\"em_font1\" height=\"42\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; font-weight:bold; color:#30373b; text-transform:uppercase;\"> <span style=\"color:#33cc33;\">Date de facturation :</span> "+facturationDate+" </td></tr></tbody></table> </td></tr></tbody></table> </td></tr></tbody></table> </td></tr><tr> <td height=\"20\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" bgcolor=\"#f6f7f8\"> <tbody><tr> <td width=\"25\" class=\"em_space\">&nbsp;</td><td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"> <tbody><tr> <td height=\"12\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td align=\"left\" valign=\"top\" class=\"em_font1\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:20px; font-weight:bold; color:#33cc33; text-transform:uppercase;\">Client : &nbsp;<span style=\" color:#30373b;\">"+clientFullName+"</span></td></tr><tr> <td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"> <tbody><tr> <td align=\"left\" width=\"180\" class=\"em_hide\">&nbsp;</td><td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"> <tbody><tr> <td height=\"10\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td align=\"left\" class=\"em_font2\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px;line-height:20px; color:#30373b;\"> "+clientAddress+" ,"+clientCity+", "+clientCountry+" . </td></tr></tbody></table> </td></tr></tbody></table> </td></tr><tr> <td height=\"12\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr></tbody></table> </td><td width=\"25\" class=\"em_space\">&nbsp;</td></tr></tbody></table> </td></tr><tr> <td height=\"25\" class=\"em_height\">&nbsp;</td></tr><tr> <td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"> <tbody><tr> <td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\"> <tbody><tr> <td width=\"30\" class=\"em_hide\">&nbsp;</td><td width=\"255\" valign=\"top\" align=\"left\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:24px; color:#30373b; font-weight:bold;\">Chambres</td><td width=\"5\"></td><td width=\"35\" class=\"em_width55\" valign=\"top\" align=\"left\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:24px; color:#30373b; font-weight:bold;\">Quantité</td><td width=\"138\" class=\"em_hide\"></td><td width=\"5\"></td><td align=\"right\" class=\"em_width75\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:24px; color:#30373b; font-weight:bold;\">Total</td><td width=\"30\" class=\"em_hide\">&nbsp;</td></tr></tbody></table> </td></tr><tr> <td height=\"14\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td height=\"1\" bgcolor=\"#eaebeb\" style=\"font-size:0px;line-height:0px;\"><img src=\"https://www.sendwithus.com/assets/img/emailmonks/images/spacer.gif\" width=\"1\" height=\"1\" alt=\"\" style=\"display:block;\" border=\"0\"></td></tr><tr> <td height=\"14\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\"> <tbody><tr> <td width=\"30\" class=\"em_hide\">&nbsp;</td><td width=\"255\" valign=\"top\" align=\"left\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:24px; color:#30373b;\">Chambre simple</td><td width=\"5\"></td><td width=\"35\" class=\"em_width55\" valign=\"top\" align=\"center\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:24px; color:#30373b;\">"+simpleQuantity+"</td><td width=\"138\" class=\"em_hide\"></td><td width=\"5\"></td><td align=\"right\" valign=\"top\" class=\"em_width75\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:24px; color:#30373b;\">"+simplePrice+"</td><td width=\"30\" class=\"em_hide\">&nbsp;</td></tr></tbody></table> </td></tr><tr> <td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\"> <tbody><tr> <td width=\"30\" class=\"em_hide\">&nbsp;</td><td width=\"255\" valign=\"top\" align=\"left\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:24px; color:#30373b;\">Chambre double</td><td width=\"5\"></td><td width=\"35\" class=\"em_width55\" valign=\"top\" align=\"center\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:24px; color:#30373b;\">"+doubleQuantity+"</td><td width=\"138\" class=\"em_hide\"></td><td width=\"5\"></td><td align=\"right\" valign=\"top\" class=\"em_width75\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:24px; color:#30373b;\">"+doublePrice+"</td><td width=\"30\" class=\"em_hide\">&nbsp;</td></tr></tbody></table> </td></tr><tr> <td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\"> <tbody><tr> <td width=\"30\" class=\"em_hide\">&nbsp;</td><td width=\"255\" valign=\"top\" align=\"left\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:24px; color:#30373b;\">Suite Junior</td><td width=\"5\"></td><td width=\"35\" class=\"em_width55\" valign=\"top\" align=\"center\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:24px; color:#30373b;\">"+juniorQuantity+"</td><td width=\"138\" class=\"em_hide\"></td><td width=\"5\"></td><td align=\"right\" valign=\"top\" class=\"em_width75\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:24px; color:#30373b;\">"+juniorPrice+"</td><td width=\"30\" class=\"em_hide\">&nbsp;</td></tr></tbody></table> </td></tr><tr> <td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\"> <tbody><tr> <td width=\"30\" class=\"em_hide\">&nbsp;</td><td width=\"255\" valign=\"top\" align=\"left\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:24px; color:#30373b;\">Suite executive</td><td width=\"5\"></td><td width=\"35\" class=\"em_width55\" valign=\"top\" align=\"center\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:24px; color:#30373b;\">"+executiveQuantity+"</td><td width=\"138\" class=\"em_hide\"></td><td width=\"5\"></td><td align=\"right\" valign=\"top\" class=\"em_width75\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:24px; color:#30373b;\">"+executivePrice+"</td><td width=\"30\" class=\"em_hide\">&nbsp;</td></tr></tbody></table> </td></tr><tr> <td height=\"8\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td height=\"9\" class=\"em_hide\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td height=\"1\" bgcolor=\"#feae39\" style=\"font-size:0px;line-height:0px;\"><img src=\"https://www.sendwithus.com/assets/img/emailmonks/images/spacer.gif\" width=\"1\" height=\"1\" alt=\"\" style=\"display:block;\" border=\"0\"></td></tr><tr> <td height=\"15\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\"> <tbody><tr> <td align=\"right\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:20px; line-height:24px; color:#30373b; font-weight:bold;\">Total: &nbsp;&nbsp; "+totalPrice+"</td><td width=\"30\" class=\"em_hide\">&nbsp;</td></tr></tbody></table> </td></tr><tr> <td height=\"28\" class=\"em_height\">&nbsp;</td></tr></tbody></table> </td></tr><tr> <td align=\"center\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:16px; line-height:22px; color:#30373b;\"> Feel free to review your invoice below or click the<br class=\"em_hide\"> button to view your account. </td></tr><tr> <td height=\"12\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td valign=\"top\" align=\"center\"> <table width=\"210\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\"> <tbody><tr> <td valign=\"middle\" align=\"center\" height=\"45\" bgcolor=\"#33cc33\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; font-weight:bold; color:#ffffff; text-transform:uppercase;\"><a href=\"#\" target=\"_blank\" style=\"line-height:45px; display:block; color:#ffffff; text-decoration:none;\">My account</a></td></tr></tbody></table> </td></tr><tr> <td height=\"31\" class=\"em_height\">&nbsp;</td></tr></tbody></table> </td></tr><tr> <td valign=\"top\" class=\"em_aside\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"> <tbody><tr> <td valign=\"middle\" align=\"center\" class=\"auto-style1\"> <h1><strong>Informations pour les professionnel</strong>s</h1> </td></tr><tr> <td height=\"14\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td height=\"25\" class=\"em_height\">&nbsp;</td></tr><tr> <td height=\"1\" bgcolor=\"#d6d7d8\" style=\"font-size:0px;line-height:0px;\"><img src=\"https://www.sendwithus.com/assets/img/emailmonks/images/spacer.gif\" width=\"1\" height=\"1\" alt=\"\" style=\"display:block;\" border=\"0\"></td></tr><tr> <td height=\"27\" class=\"em_height\">&nbsp;</td></tr><tr> <td valign=\"top\" align=\"center\" style=\"line-height:22px; \" class=\"auto-style8\">La Résidence des Hauts de Menaye est à l'écoute de vos moindre besoin, n'hésitez pas à nous contacter pour la moindre information ou remarque.</td></tr><tr> <td height=\"23\" class=\"em_height\">&nbsp;</td></tr><tr> <td valign=\"top\"></td></tr><tr> <td height=\"20\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" bgcolor=\"#f6f7f8\" class=\"auto-style2\"> <tbody><tr> <td width=\"25\" class=\"em_space\">&nbsp;</td><td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"> <tbody><tr> <td height=\"12\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td align=\"left\" valign=\"top\" class=\"em_font1\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:20px; font-weight:bold; color:#33cc33; text-transform:uppercase;\">Information : &nbsp;<span style=\" color:#30373b;\">Une connexion internet</span></td></tr><tr> <td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" class=\"auto-style3\"> <tbody><tr> <td align=\"left\" width=\"180\" class=\"em_hide\"> <img src=\"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ0q272_RLW9q4WhkbqMlgTGLdCFUfPNHVhzvi2w9FNY9BZh-RhSAHxdQ\" class=\"auto-style4\"> </td><td valign=\"top\"> <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" class=\"auto-style6\"> <tbody><tr> <td height=\"10\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td align=\"left\" class=\"auto-style5\" style=\"line-height:20px; \"> La Résidence des Hauts de Menaye est équipé de connexion Wi-Fi accessible dans tout l'hôtel. Vous pouvez donc vous présenter à l'accueil pour demander à avoir accès au Wi-fi. </td></tr></tbody></table> </td></tr></tbody></table> </td></tr><tr> <td height=\"12\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr></tbody></table> </td><td width=\"25\" class=\"em_space\">&nbsp;</td></tr></tbody></table> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" bgcolor=\"#f6f7f8\" class=\"auto-style2\"> <tbody><tr> <td width=\"25\" class=\"em_space\">&nbsp;</td><td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"> <tbody><tr> <td height=\"12\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td align=\"left\" valign=\"top\" class=\"em_font1\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:20px; font-weight:bold; color:#33cc33; text-transform:uppercase;\">Information : &nbsp;<span style=\" color:#30373b;\">Vos déplacements</span></td></tr><tr> <td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" class=\"auto-style3\"> <tbody><tr> <td align=\"left\" width=\"180\" class=\"em_hide\"> <img src=\"http://images.clipartlogo.com/files/images/17/174558/aiga-ground-transportation-bg_t\" class=\"auto-style4\"> </td><td valign=\"top\"> <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" class=\"auto-style6\"> <tbody><tr> <td height=\"10\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td align=\"left\" class=\"auto-style5\" style=\"line-height:20px; \">Si vous souhaitez vous déplacer, seul ou en groupe, la Résidence des Hauts de Menaye pourra mettre à votre disposition un taxi ou un bus pour assurer vos déplacements dans la ville.</td></tr></tbody></table> </td></tr></tbody></table> </td></tr><tr> <td height=\"12\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr></tbody></table> </td><td width=\"25\" class=\"em_space\">&nbsp;</td></tr></tbody></table> </td></tr><tr> <td height=\"25\" class=\"em_height\">&nbsp;</td></tr><tr> <td valign=\"top\"></td></tr><tr> <td align=\"center\" style=\"line-height:22px; \" class=\"auto-style7\">En cas de déplacements importants, nous vous conseillons de contacter l'hôtel à l'avance et de préciser le nombre de personnes qui se dépalceront avec vous afin que nous puissions prendre nos dispositions.</td></tr><tr> <td height=\"12\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td valign=\"top\" align=\"center\"> <table width=\"210\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\"> <tbody><tr> <td valign=\"middle\" align=\"center\" height=\"45\" bgcolor=\"#feae39\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; font-weight:bold; color:#ffffff; text-transform:uppercase;\">CONTACT</td></tr></tbody></table> </td></tr><tr> <td height=\"31\" class=\"em_height\">&nbsp;</td></tr></tbody></table> </td></tr></tbody></table> </td></tr><tr> <td align=\"center\" valign=\"top\" bgcolor=\"#30373b\" class=\"em_aside\"> <table width=\"600\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" align=\"center\" class=\"em_main_table\" style=\"table-layout:fixed;\"> <tbody><tr> <td height=\"35\" class=\"em_height\">&nbsp;</td></tr><tr> <td align=\"center\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:12px; line-height:18px; color:#848789;text-transform:uppercase;\"> If you do not wish to receive any further emails from us, please <span style=\"text-decoration:underline;\"><a href=\"#\" target=\"_blank\" style=\"text-decoration:underline; color:#848789;\">unsubscribe</a></span> </td></tr><tr> <td height=\"35\" class=\"em_height\">&nbsp;</td></tr></tbody></table> </td></tr></tbody></table> <div style=\"display:none; white-space:nowrap; font:20px courier; color:#ffffff; background-color:#ffffff;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</div></body></html>";
    }

    private String getInvoiceHobbyForMail(String bookingNum,String facturationDate,String clientFullName,String clientAddress,String clientCity,String clientCountry,int simpleQuantity,int doubleQuantity,int juniorQuantity,int executiveQuantity,double simplePrice,double doublePrice,double juniorPrice,double executivePrice,double totalPrice)
    {
        return "<html xmlns=\"http://www.w3.org/1999/xhtml\"><head> <title>THANK YOU</title> <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"> <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"> <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0 \"> <meta name=\"format-detection\" content=\"telephone=no\"> <link href=\"https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700,800\" rel=\"stylesheet\"> <style type=\"text/css\"> body{-webkit-text-size-adjust: 100% !important; -ms-text-size-adjust: 100% !important; -webkit-font-smoothing: antialiased !important;}img{border: 0 !important; outline: none !important;}p{Margin: 0px !important; Padding: 0px !important;}table{border-collapse: collapse; mso-table-lspace: 0px; mso-table-rspace: 0px;}td, a, span{border-collapse: collapse; mso-line-height-rule: exactly;}.ExternalClass *{line-height: 100%;}span.MsoHyperlink{mso-style-priority: 99; color: inherit;}span.MsoHyperlinkFollowed{mso-style-priority: 99; color: inherit;}.auto-style1{color: #33CC33;}.auto-style2{height: 157px;}.auto-style3{height: 99px;}.auto-style4{width: 100%;}.auto-style5{font-family: \"Open Sans\", Arial, sans-serif; font-size: 17px; color: #30373B;}.auto-style6{height: 154px; width: 93%;}.auto-style7{font-family: \"Open Sans\", Arial, sans-serif; font-size: 16px; color: #30373B;}</style> <style media=\"only screen and (min-width:481px) and (max-width:599px)\" type=\"text/css\"> @media only screen and (min-width:481px) and (max-width:599px){table[class=em_main_table]{width: 100% !important;}table[class=em_wrapper]{width: 100% !important;}td[class=em_hide], br[class=em_hide]{display: none !important;}img[class=em_full_img]{width: 100% !important; height: auto !important;}td[class=em_align_cent]{text-align: center !important;}td[class=em_pad_top]{padding-top: 20px !important;}td[class=em_aside]{padding-left: 10px !important; padding-right: 10px !important;}td[class=em_height]{height: 20px !important;}td[class=em_space]{width: 10px !important;}td[class=em_width55]{width: 80px !important; text-align: center !important;}td[class=em_width75]{width: 100px !important;}td[class=em_font]{font-size: 14px !important;}td[class=em_font2]{text-align: center !important;}td[class=em_align_cent1]{text-align: center !important; padding-bottom: 10px !important;}}</style> <style media=\"only screen and (max-width:480px)\" type=\"text/css\"> @media only screen and (max-width:480px){table[class=em_main_table]{width: 100% !important;}table[class=em_wrapper]{width: 100% !important;}td[class=em_hide], br[class=em_hide], span[class=em_hide]{display: none !important;}img[class=em_full_img]{width: 100% !important; height: auto !important;}td[class=em_align_cent]{text-align: center !important;}td[class=em_pad_top]{padding-top: 20px !important;}td[class=em_height]{height: 20px !important;}td[class=em_aside]{padding-left: 10px !important; padding-right: 10px !important;}td[class=em_font]{font-size: 14px !important; line-height: 28px !important;}td[class=em_font1]{font-size: 14px !important; line-height: 18px !important;}td[class=em_font2]{font-size: 14px !important; line-height: 18px !important; text-align: center !important;}td[class=em_space]{width: 10px !important;}span[class=em_br]{display: block !important;}td[class=em_width55]{width: 55px !important; font-size: 15px !important; line-height: 19px !important; text-align: center !important;}td[class=em_width75]{width: 75px !important; font-size: 15px !important; line-height: 19px !important;}td[class=em_align_cent1]{text-align: center !important; padding-bottom: 10px !important;}}</style></head><body style=\"margin:0px; padding:0px;\" bgcolor=\"#ffffff\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" bgcolor=\"#ffffff\"> <tbody><tr> <td align=\"center\" valign=\"top\" bgcolor=\"#ffffff\"> <hr><table width=\"600\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" align=\"center\" class=\"em_main_table\" style=\"table-layout:fixed;\"> <tbody><tr> <td height=\"40\" class=\"em_height\">&nbsp;</td></tr><tr> <td align=\"center\"><a href=\"#\" target=\"_blank\" style=\"text-decoration:none;\"><img src=\"http://residencedeshautsdemenaye.com/img/logoRHM.png\" width=\"390\" height=\"283\" style=\"display:block;font-family: Arial, sans-serif; font-size:15px; line-height:18px; color:#30373b; font-weight:bold;\" border=\"0\" alt=\"LoGo Here\"></a></td></tr><tr> <td height=\"30\" class=\"em_height\">&nbsp;</td></tr><tr> <td height=\"1\" bgcolor=\"#fed69c\" style=\"font-size:0px; line-height:0px;\"><img src=\"https://www.sendwithus.com/assets/img/emailmonks/images/spacer.gif\" width=\"1\" height=\"1\" style=\"display:block;\" border=\"0\" alt=\"\"></td></tr><tr> <td height=\"14\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td align=\"center\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:15px; line-height:18px; color:#30373b; text-transform:uppercase; font-weight:bold;\" class=\"em_font\"> <a href=\"#\" target=\"_blank\" style=\"text-decoration:none; color:#30373b;\">HOTEL</a> &nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp; <a href=\"#\" target=\"_blank\" style=\"text-decoration:none; color:#30373b;\">RESTAURANT</a> <span class=\"em_hide\"> &nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp; </span> <span class=\"em_br\"> </span><a href=\"#\" target=\"_blank\" style=\"text-decoration:none; color:#30373b;\">EVENTS</a> &nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp; <a href=\"#\" target=\"_blank\" style=\"text-decoration:none; color:#30373b;\">CONTACTEZ-NOUS</a> </td></tr><tr> <td height=\"14\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td height=\"1\" bgcolor=\"#fed69c\" style=\"font-size:0px; line-height:0px;\"><img src=\"https://www.sendwithus.com/assets/img/emailmonks/images/spacer.gif\" width=\"1\" height=\"1\" style=\"display:block;\" border=\"0\" alt=\"\"></td></tr><tr> <td valign=\"top\" class=\"em_aside\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"> <tbody><tr> <td height=\"50\" class=\"em_height\">&nbsp;</td></tr><tr> <td valign=\"middle\" align=\"center\"><h1>NOUS VOUS REMERCIONS</h1></td></tr><tr> <td height=\"14\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td align=\"center\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:18px; font-weight:bold; line-height:22px; color:#33cc33; text-transform:uppercase;\">Pour votre réservation!</td></tr><tr> <td height=\"25\" class=\"em_height\">&nbsp;</td></tr><tr> <td height=\"1\" bgcolor=\"#d6d7d8\" style=\"font-size:0px;line-height:0px;\"><img src=\"https://www.sendwithus.com/assets/img/emailmonks/images/spacer.gif\" width=\"1\" height=\"1\" alt=\"\" style=\"display:block;\" border=\"0\"></td></tr><tr> <td height=\"27\" class=\"em_height\">&nbsp;</td></tr><tr> <td valign=\"top\" align=\"center\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px;line-height:22px; font-weight:bold; color:#30373b; text-transform:uppercase;\">Votre facture</td></tr><tr> <td height=\"23\" class=\"em_height\">&nbsp;</td></tr><tr> <td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"> <tbody><tr> <td valign=\"top\"> <table width=\"290\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"left\" class=\"em_wrapper\" bgcolor=\"#f6f7f8\"> <tbody><tr> <td align=\"center\" valign=\"middle\" class=\"em_font1\" height=\"42\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; font-weight:bold; color:#30373b; text-transform:uppercase;\"> <span style=\"color:#33cc33;\">Numéro de réservation :</span> "+bookingNum+"</td></tr></tbody></table> <table width=\"290\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"right\" class=\"em_wrapper\"> <tbody><tr> <td valign=\"top\" class=\"em_pad_top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" bgcolor=\"#f6f7f8\"> <tbody><tr> <td align=\"center\" valign=\"middle\" class=\"em_font1\" height=\"42\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; font-weight:bold; color:#30373b; text-transform:uppercase;\"> <span style=\"color:#33cc33;\">Date de facturation :</span>" +facturationDate+" </td></tr></tbody></table> </td></tr></tbody></table> </td></tr></tbody></table> </td></tr><tr> <td height=\"20\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" bgcolor=\"#f6f7f8\"> <tbody><tr> <td width=\"25\" class=\"em_space\">&nbsp;</td><td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"> <tbody><tr> <td height=\"12\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td align=\"left\" valign=\"top\" class=\"em_font1\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:20px; font-weight:bold; color:#33cc33; text-transform:uppercase;\">Client : &nbsp;<span style=\" color:#30373b;\">"+clientFullName+"</span></td></tr><tr> <td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"> <tbody><tr> <td align=\"left\" width=\"180\" class=\"em_hide\">&nbsp;</td><td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"> <tbody><tr> <td height=\"10\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td align=\"left\" class=\"em_font2\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px;line-height:20px; color:#30373b;\">"+ clientAddress+", "+clientCity+", "+clientCountry+"</td></tr></tbody></table> </td></tr></tbody></table> </td></tr><tr> <td height=\"12\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr></tbody></table> </td><td width=\"25\" class=\"em_space\">&nbsp;</td></tr></tbody></table> </td></tr><tr> <td height=\"25\" class=\"em_height\">&nbsp;</td></tr><tr> <td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"> <tbody><tr> <td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\"> <tbody><tr> <td width=\"30\" class=\"em_hide\">&nbsp;</td><td width=\"255\" valign=\"top\" align=\"left\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:24px; color:#30373b; font-weight:bold;\">Chambres</td><td width=\"5\"></td><td width=\"35\" class=\"em_width55\" valign=\"top\" align=\"left\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:24px; color:#30373b; font-weight:bold;\">Quantité</td><td width=\"138\" class=\"em_hide\"></td><td width=\"5\"></td><td align=\"right\" class=\"em_width75\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:24px; color:#30373b; font-weight:bold;\">Total</td><td width=\"30\" class=\"em_hide\">&nbsp;</td></tr></tbody></table> </td></tr><tr> <td height=\"14\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td height=\"1\" bgcolor=\"#eaebeb\" style=\"font-size:0px;line-height:0px;\"><img src=\"https://www.sendwithus.com/assets/img/emailmonks/images/spacer.gif\" width=\"1\" height=\"1\" alt=\"\" style=\"display:block;\" border=\"0\"></td></tr><tr> <td height=\"14\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\"> <tbody><tr> <td width=\"30\" class=\"em_hide\">&nbsp;</td><td width=\"255\" valign=\"top\" align=\"left\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:24px; color:#30373b;\">Chambre Simple</td><td width=\"5\"></td><td width=\"35\" class=\"em_width55\" valign=\"top\" align=\"center\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:24px; color:#30373b;\">"+simpleQuantity+"</td><td width=\"138\" class=\"em_hide\"></td><td width=\"5\"></td><td align=\"right\" valign=\"top\" class=\"em_width75\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:24px; color:#30373b;\">"+simplePrice+"</td><td width=\"30\" class=\"em_hide\">&nbsp;</td></tr></tbody></table> </td></tr><tr> <td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\"> <tbody><tr> <td width=\"30\" class=\"em_hide\">&nbsp;</td><td width=\"255\" valign=\"top\" align=\"left\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:24px; color:#30373b;\">Chambre Double</td><td width=\"5\"></td><td width=\"35\" class=\"em_width55\" valign=\"top\" align=\"center\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:24px; color:#30373b;\">"+doubleQuantity+"</td><td width=\"138\" class=\"em_hide\"></td><td width=\"5\"></td><td align=\"right\" valign=\"top\" class=\"em_width75\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:24px; color:#30373b;\">"+doublePrice+"</td><td width=\"30\" class=\"em_hide\">&nbsp;</td></tr></tbody></table> </td></tr><tr> <td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\"> <tbody><tr> <td width=\"30\" class=\"em_hide\">&nbsp;</td><td width=\"255\" valign=\"top\" align=\"left\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:24px; color:#30373b;\">Suite Junior</td><td width=\"5\"></td><td width=\"35\" class=\"em_width55\" valign=\"top\" align=\"center\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:24px; color:#30373b;\">"+juniorQuantity+"</td><td width=\"138\" class=\"em_hide\"></td><td width=\"5\"></td><td align=\"right\" valign=\"top\" class=\"em_width75\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:24px; color:#30373b;\">"+juniorPrice+"</td><td width=\"30\" class=\"em_hide\">&nbsp;</td></tr></tbody></table> </td></tr><tr> <td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\"> <tbody><tr> <td width=\"30\" class=\"em_hide\">&nbsp;</td><td width=\"255\" valign=\"top\" align=\"left\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:24px; color:#30373b;\">Suite executive</td><td width=\"5\"></td><td width=\"35\" class=\"em_width55\" valign=\"top\" align=\"center\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:24px; color:#30373b;\">"+executiveQuantity+"</td><td width=\"138\" class=\"em_hide\"></td><td width=\"5\"></td><td align=\"right\" valign=\"top\" class=\"em_width75\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:24px; color:#30373b;\">"+executivePrice+"</td><td width=\"30\" class=\"em_hide\">&nbsp;</td></tr></tbody></table> </td></tr><tr> <td height=\"9\" class=\"em_hide\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td height=\"1\" bgcolor=\"#feae39\" style=\"font-size:0px;line-height:0px;\"><img src=\"https://www.sendwithus.com/assets/img/emailmonks/images/spacer.gif\" width=\"1\" height=\"1\" alt=\"\" style=\"display:block;\" border=\"0\"></td></tr><tr> <td height=\"15\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\"> <tbody><tr> <td align=\"right\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:20px; line-height:24px; color:#30373b; font-weight:bold;\">Total: &nbsp;&nbsp; "+totalPrice+"</td><td width=\"30\" class=\"em_hide\">&nbsp;</td></tr></tbody></table> </td></tr><tr> <td height=\"28\" class=\"em_height\">&nbsp;</td></tr></tbody></table> </td></tr><tr> <td align=\"center\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:16px; line-height:22px; color:#30373b;\"> Feel free to review your invoice below or click the<br class=\"em_hide\"> button to view your account. </td></tr><tr> <td height=\"12\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td valign=\"top\" align=\"center\"> <table width=\"210\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\"> <tbody><tr> <td valign=\"middle\" align=\"center\" height=\"45\" bgcolor=\"#33cc33\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; font-weight:bold; color:#ffffff; text-transform:uppercase;\"><a href=\"#\" target=\"_blank\" style=\"line-height:45px; display:block; color:#ffffff; text-decoration:none;\">My account</a></td></tr></tbody></table> </td></tr><tr> <td height=\"31\" class=\"em_height\">&nbsp;</td></tr></tbody></table> </td></tr><tr> <td valign=\"top\" class=\"em_aside\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"> <tbody><tr> <td valign=\"middle\" align=\"center\" class=\"auto-style1\"> <h1><strong>Propositions de Loisirs</strong></h1> </td></tr><tr> <td height=\"14\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td height=\"25\" class=\"em_height\">&nbsp;</td></tr><tr> <td height=\"1\" bgcolor=\"#d6d7d8\" style=\"font-size:0px;line-height:0px;\"><img src=\"https://www.sendwithus.com/assets/img/emailmonks/images/spacer.gif\" width=\"1\" height=\"1\" alt=\"\" style=\"display:block;\" border=\"0\"></td></tr><tr> <td height=\"27\" class=\"em_height\">&nbsp;</td></tr><tr> <td valign=\"top\" align=\"center\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px;line-height:22px; font-weight:bold; color:#30373b;\"> Le Gabon est un pays composé de 9 provinces.<br>La Résidence des Hauts de Ménaye se situe à Menaye Epila dans la province du Hauts Ogooué.<br>Le Haut Ogooué possède plusieurs sites touristiques dont notre hôtel est pr&amp;êt à faire profiter ses clients. </td></tr><tr> <td height=\"23\" class=\"em_height\">&nbsp;</td></tr><tr> <td valign=\"top\"></td></tr><tr> <td height=\"20\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" bgcolor=\"#f6f7f8\" class=\"auto-style2\"> <tbody><tr> <td width=\"25\" class=\"em_space\">&nbsp;</td><td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"> <tbody><tr> <td height=\"12\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td align=\"left\" valign=\"top\" class=\"em_font1\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:20px; font-weight:bold; color:#33cc33; text-transform:uppercase;\">Découvrez : &nbsp;<span style=\" color:#30373b;\">Le pont de Liane de poubara</span></td></tr><tr> <td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" class=\"auto-style3\"> <tbody><tr> <td align=\"left\" width=\"180\" class=\"em_hide\"> <img src=\"http://img.over-blog-kiwi.com/0/81/72/74/ob_bb03d8_pont-lianes-2.jpg\" class=\"auto-style4\"> </td><td valign=\"top\"> <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" class=\"auto-style6\"> <tbody><tr> <td height=\"10\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td align=\"left\" class=\"auto-style5\" style=\"line-height:20px; \"> Le pont de liane de Franceville est l'une des attractions les plus célèbre du Gabon.<br>Ce pont construit au dessus des rapides de poubara est pour la chance de vivre une expérience riche en frisson. </td></tr></tbody></table> </td></tr></tbody></table> </td></tr><tr> <td height=\"12\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr></tbody></table> </td><td width=\"25\" class=\"em_space\">&nbsp;</td></tr></tbody></table> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" bgcolor=\"#f6f7f8\" class=\"auto-style2\"> <tbody><tr> <td width=\"25\" class=\"em_space\">&nbsp;</td><td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"> <tbody><tr> <td height=\"12\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td align=\"left\" valign=\"top\" class=\"em_font1\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:20px; font-weight:bold; color:#33cc33; text-transform:uppercase;\">Découvrez : &nbsp;<span style=\" color:#30373b;\">LeS chutes de poubara</span></td></tr><tr> <td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" class=\"auto-style3\"> <tbody><tr> <td align=\"left\" width=\"180\" class=\"em_hide\"> <img src=\"http://img.over-blog-kiwi.com/0/81/72/74/ob_d6f93e_chutes-de-poubara-1.jpg\" class=\"auto-style4\"> </td><td valign=\"top\"> <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" class=\"auto-style6\"> <tbody><tr> <td height=\"10\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td align=\"left\" class=\"auto-style5\" style=\"line-height:20px; \"> Les chutes de poubara font partie comme le pont de liane des attarctions touristique de poubara. <br>Vous pourrez partir en excursion à travers la forêt pour atteindre les chutes de poubara. </td></tr></tbody></table> </td></tr></tbody></table> </td></tr><tr> <td height=\"12\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr></tbody></table> </td><td width=\"25\" class=\"em_space\">&nbsp;</td></tr></tbody></table> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" bgcolor=\"#f6f7f8\" class=\"auto-style2\"> <tbody><tr> <td width=\"25\" class=\"em_space\">&nbsp;</td><td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"> <tbody><tr> <td height=\"12\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td align=\"left\" valign=\"top\" class=\"em_font1\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; line-height:20px; font-weight:bold; color:#33cc33; text-transform:uppercase;\">Découvrez : &nbsp;<span style=\" color:#30373b;\">Le canyone de leconie</span></td></tr><tr> <td valign=\"top\"> <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" class=\"auto-style3\"> <tbody><tr> <td align=\"left\" width=\"180\" class=\"em_hide\"> <img class=\"auto-style4\" src=\"http://tobo.astride.free.fr/images/canyondelaconi.jpg\"> </td><td valign=\"top\"> <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" class=\"auto-style6\"> <tbody><tr> <td height=\"10\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td align=\"left\" class=\"auto-style5\" style=\"line-height:20px; \"> Vous aurrez aussi la possibilité de visiter les canyons de Leconie.<br>Vous pourrez admirerer la vue qu'offre ce magnifique paysage. </td></tr></tbody></table> </td></tr></tbody></table> </td></tr><tr> <td height=\"12\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr></tbody></table> </td><td width=\"25\" class=\"em_space\">&nbsp;</td></tr></tbody></table> </td></tr><tr> <td height=\"25\" class=\"em_height\">&nbsp;</td></tr><tr> <td valign=\"top\"></td></tr><tr> <td align=\"center\" style=\"line-height:22px; \" class=\"auto-style7\">Pour effectuer toute visite, veuillez contacter l'hôtel dans le lien suivant en précisant quel site vous désirez visiter.</td></tr><tr> <td height=\"12\" style=\"font-size:1px; line-height:1px;\">&nbsp;</td></tr><tr> <td valign=\"top\" align=\"center\"> <table width=\"210\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\"> <tbody><tr> <td valign=\"middle\" align=\"center\" height=\"45\" bgcolor=\"#33cc33\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:17px; font-weight:bold; color:#ffffff; text-transform:uppercase;\">CONTACT</td></tr></tbody></table> </td></tr><tr> <td height=\"31\" class=\"em_height\">&nbsp;</td></tr></tbody></table> </td></tr></tbody></table> </td></tr><tr> <td align=\"center\" valign=\"top\" bgcolor=\"#30373b\" class=\"em_aside\"> <table width=\"600\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" align=\"center\" class=\"em_main_table\" style=\"table-layout:fixed;\"> <tbody><tr> <td height=\"35\" class=\"em_height\">&nbsp;</td></tr><tr> <td align=\"center\" style=\"font-family:'Open Sans', Arial, sans-serif; font-size:12px; line-height:18px; color:#848789;text-transform:uppercase;\"> If you do not wish to receive any further emails from us, please <span style=\"text-decoration:underline;\"><a href=\"#\" target=\"_blank\" style=\"text-decoration:underline; color:#848789;\">unsubscribe</a></span> </td></tr><tr> <td height=\"35\" class=\"em_height\">&nbsp;</td></tr></tbody></table> </td></tr></tbody></table> <div style=\"display:none; white-space:nowrap; font:20px courier; color:#ffffff; background-color:#ffffff;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</div></body></html>";
    }

    public void generateInvoice(String pdfDestinationPath, Client client, List<RoomBooking> roomBookingList){
        //Upper, Lower et Row htmlForPdf represente le code html qui nous permet de generer une facture pour la comptabilité hotelière

        String upperHtmlForPdf = "<!DOCTYPE html><html lang=\"en\" xmlns=\"http://www.w3.org/1999/xhtml\"><head> <meta charset=\"utf-8\"/> <title></title> <style type=\"text/css\"> .auto-style1{margin-top: 5%; border: 2px solid black; width: 100%; margin-top: 4%;}.right{float: right;}.left{float: left;}table, th, td{border: 1px solid black; border-collapse: collapse;}th, td{padding: 5px; text-align: left;}.clientTable, .bookingTable{width: 100%;}</style></head><body> <div class=\"auto-style1\"> <img src=\"http://residencedeshautsdemenaye.com/img/logoRHM.png\"/> <div class=\"right\"> <h2>Facture</h2> <strong>Date</strong> : invoiceDate </div></div><div class=\"clientInfo\"> <br/> <br/> <table class=\"clientTable\"> <caption>Informations client</caption> <tr> <td>clientFullname</td><td>clientPhone</td></tr><tr> <td>clientCountry</td><td>clientBirthday</td></tr><tr> <td>clientCity</td><td>clientEmail</td></tr><tr> <td colspan=\"2\">clientAddress</td></tr></table> </div><br/> <div class=\"bookingInfo\"> <table class=\"bookingTable\"> <caption>Informations de réservation</caption> <tr> <th>Chambre </th> <th>Quantité </th> <th>Arrivé </th> <th>Départ </th> <th>Nuit (s) </th> <th>Prix / nuit (s) </th> <th>Total </th> </tr>";
        String tableRowForPdf = "<tr><td>roomType</td> <td>roomCount</td> <td>roomCheckin</td><td>RoomCheckout</td><td>countNights</td><td>roomPrice</td><td>roomTotalPrice</td></tr>";
        String lowerHtmlForPdf = "<tr><td colspan=\"3\"><strong>Total de la facture</strong></td> <td colspan=\"3\">invoiceTotal</td> </tr> </table></div></body></html>";
        double totalCount=0;


        String[] listOfOld = {"invoiceDate","clientFullname","clientEmail","clientCity","clientCountry","clientPhone","clientAddress"/*,"clientBirthday"*/};
        String[] listOfNew = {dateInString,client.getLastName()+" "+client.getFirstName(),client.getEmail(),client.getCity(),client.getCountry(),client.getPhone().toString(),client.getAddress()/*,client.getBirthday().toString()*/};

        //System.out.println(" la date du jour : " + dateInString);

        upperHtmlForPdf = replaceListOfValueInText(upperHtmlForPdf,listOfOld,listOfNew);
/*
        this.upperHtml = replaceValueInText(this.upperHtml, this.InvoiceDate, dateInString);
        this.upperHtml = replaceValueInText(this.upperHtml, this.InvoiceClientName, this.client.nom+" "+this.client.prenom);
        this.upperHtml = replaceValueInText(this.upperHtml, this.InvoiceClientEmail, this.client.email);
        this.upperHtml = replaceValueInText(this.upperHtml, this.InvoiceClientCity, this.client.ville);
        this.upperHtml = replaceValueInText(this.upperHtml, this.InvoiceClientCountry, this.client.pays);
        this.upperHtml = replaceValueInText(this.upperHtml, this.InvoiceClientPhone, this.client.phone);
        this.upperHtml = replaceValueInText(this.upperHtml, this.InvoiceClientAddress, this.client.adresse);
        this.upperHtml = replaceValueInText(this.upperHtml, this.InvoiceClientBirthday, this.client.anniversaire);
*/
        //ici on ajoute les infos de chambre
        for (RoomBooking b: roomBookingList) {
            String rowToAdd = tableRowForPdf;

            //rowToAdd = replaceListOfValueInText(rowToAdd,listOfOld,listOfNew);

            rowToAdd = replaceValueInText(rowToAdd,"roomType", /*b.getIdRoomCategory().toString()*/"aqwx")
                    //.replace("roomCount",""+b.quantité)
                    .replace("roomCheckin",b.getDateStart().toString())
                    .replace("RoomCheckout",b.getDateEnd().toString());
            //.replace("countNights",""+b.nuit)
            //.replace("roomPrice", ( ""+b.prixNuit))
            //  .replace("roomTotalPrice",""+b.total);

            upperHtmlForPdf = upperHtmlForPdf + rowToAdd;
            //System.out.println(toAdd);
            totalCount = totalCount +0/*b.total*/;
        }
        String finalHtml = upperHtmlForPdf + lowerHtmlForPdf;
        //System.out.println(finalHtml);

        //remplace le prix total de la facture dans le fichier html comple
        finalHtml = finalHtml.replace("invoiceTotal",""+totalCount);
        convertStringToPdf(finalHtml,pdfDestinationPath);
    }

    private String replaceValueInText(String content, String oldValue,String newValue){
        String value = content.replace(oldValue,newValue);
        return value;
    }

    private String replaceListOfValueInText(String content, List<String> oldValues, List<String> newValues){
        for (String oldValue : oldValues) {
            for (String newValue : newValues) {
                content.replace(oldValue,newValue);
            }
        }
        return content;
    }
    private String replaceListOfValueInText(String content, String[] oldValues, String[] newValues){
        for(int i=0;i< oldValues.length;i++){
            content = content.replace(oldValues[i],newValues[i]);
        }/*
        for (String oldValue : oldValues) {
            for (String newValue : newValues) {
                content = content.replace(oldValue,newValue);
            }
        }*/
        return content;
    }

    public int getOccurrenceRoomBooking(Long roomId,List<RoomBooking> list){
        int count = 0;
        for(int i = 0;i<list.size();i++){
            if(list.get(i).getIdRoom() == roomId){
                count ++;
            }
        }
        return count;
    }

    private void convertStringToPdf(String invoice, String fileDestination){
        // On convertis la string qui contient du code html en fichier pdf en générant un objet document
        Document document = XMLResource.load( new ByteArrayInputStream(invoice.getBytes())).getDocument();
        ITextRenderer renderer = new ITextRenderer();
        renderer.setDocument( document, null );
        renderer.layout();
        FileOutputStream fos = null;
        try {
            fos = new FileOutputStream( fileDestination );
            renderer.createPDF( fos );
            fos.close();
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (DocumentException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
        System.out.println( "File 1: '" + fileDestination + "' created." );
    }

    public String convertHtmlFileIntoString(String htmlFile){
        StringBuilder contentBuilder = new StringBuilder();
        contentBuilder.append(htmlFile);
        String content = contentBuilder.toString();
        return content;
    }

    public static void main(String [] args) {
        //On récupère les infos des client et on les ajoute dans un objet
      /*  InvoiceGenerator.Client al = new InvoiceGenerator.Client("Ondzounga", "Alvin", "ondzoungabruce@hotmail.fr", "92190", "France", "Meudon", "25/03/1994", "0643329404", "35 route de vaugirard");
        InvoiceGenerator.Client max = new InvoiceGenerator.Client("Mollard", "Maxime", "maxime.mollard75@hotmail.fr", "75015", "France", "Paris", "25/03/1994", "0643329404", "35 route de vaugirard");
        InvoiceGenerator.Client kev = new InvoiceGenerator.Client("Vivor", "Kévin", "KevOR@hotmail.fr", "93190", "France", "Val de fontenay", "25/03/1994", "0643329404", "35 route de vaugirard");
*/
        Client a = new Client();
        a.setLastName("azerty");
        a.setFirstName("iop");
        a.setAddress("DZEDEZDE");
        a.setAddress("FAOEFKOZEJF ");
        a.setCity("LBV");
        a.setCountry("Gabon");
        a.setEmail("azerty@EFGZAEF.FR");
        a.setPhone("0643329404");
        a.setPostalCode("92190");


        RoomBooking roomBooking = new RoomBooking();
        roomBooking.setDateStart(new Date());
        roomBooking.setDateEnd(new Date());

        /*
        InvoiceGenerator.Booking reservation = new InvoiceGenerator.Booking("Chambre Double", 1, "13/11/2017", "23/12/2017", 100000);
        InvoiceGenerator.Booking r2 = new InvoiceGenerator.Booking("Chambre Double", 3, "23/11/2017", "26/12/2017", 100000);
        InvoiceGenerator.Booking r3 = new InvoiceGenerator.Booking("Suite Junior", 2, "15/11/2017", "23/12/2017", 150000);
        InvoiceGenerator.Booking r4 = new InvoiceGenerator.Booking("Suite Executive", 5, "02/11/2017", "23/12/2017", 200000);*/

        List<RoomBooking> listDeRes = new ArrayList<RoomBooking>();
        listDeRes.add(roomBooking);/*
        listDeRes.add(r2);
        listDeRes.add(r3);
        listDeRes.add(r4);*/
/*
        String upperTemplate = "C:\\Users\\stanley\\Downloads\\Spring-Email-Gmail-Smtp-Example\\ModulesIntelligents\\src\\invoiceUpperTemplate.html";
        String rowTemplate = "C:\\Users\\stanley\\Downloads\\Spring-Email-Gmail-Smtp-Example\\ModulesIntelligents\\src\\invoiceRowTemplate.html";
        String lowerTemplate = "C:\\Users\\stanley\\Downloads\\Spring-Email-Gmail-Smtp-Example\\ModulesIntelligents\\src\\invoiceLowerTemplate.html";
        String pdfFilePath = "C:\\Users\\stanley\\Downloads\\RHM_Invoice.pdf";
        InvoiceGenerator C = new InvoiceGenerator(upperTemplate, rowTemplate, lowerTemplate, pdfFilePath, al, listDeRes);*/
/*
        TemplateGenerator templateGenerator = new TemplateGenerator();
        templateGenerator.generateInvoice("C:\\Users\\stanley\\xxxx.pdf",a,listDeRes);
        MailManager mailManager = new MailManager();
        mailManager.sendEmailToClient("ondzoungabruce@hotmail.fr");*/



        TemplateGenerator templateGenerator = new TemplateGenerator();
        String Invoice = templateGenerator.getProfessionnalInvoiceForMail("reference","today"," alvin Ondzounga ",
                "adresse ","Pays","Ma ville",1,
                2,3, 4,0,0,0,0,0);

        MailManager mailManager = new MailManager();
        mailManager.sendEmailToClient("Your invoice","ondzoungabruce@hotmail.fr",Invoice);
        System.out.println("On envoie la facture par mail");

    }
}